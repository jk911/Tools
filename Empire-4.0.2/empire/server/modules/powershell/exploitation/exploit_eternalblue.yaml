name: Invoke-EternalBlue
authors:
  - Sean Dillon <sean.dillon [at] risksense.com>
  - Dylan Davis <dylan.davis [at] risksense.com>Equation Group
  - kdick@tevora.com (e0x70i)
description: 'Port of MS17_010 Metasploit module to powershell. Exploits targeted
  system and executes specified shellcode. Windows 7 and 2008 R2 supported. Potential
  for a BSOD '
software: ''
techniques:
  - T1210
background: false
output_extension:
needs_admin: false
opsec_safe: false
language: powershell
min_language_version: '2'
comments:
  - https://github.com/RiskSense-Ops/MS17-010
  - https://www.rapid7.com/db/modules/exploit/windows/smb/ms17_010_eternalblue
  - http://threat.tevora.com/eternal-blues/
options:
  - name: Agent
    description: Agent to run module on.
    required: true
    value: ''
  - name: Target
    description: 'IP or Hostname of target '
    required: true
    value: ''
  - name: MaxAttempts
    description: Number of times to try exploit (increment grooms by 5 each time)
    required: true
    value: '1'
  - name: InitialGrooms
    description: Number of Initial Grooms
    required: true
    value: '12'
  - name: Shellcode
    description: Custom shellcode to inject, 0xaa,0xab,... format.
    required: true
    value: ''
advanced:
  custom_generate: true
